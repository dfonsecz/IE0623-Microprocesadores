;*******************************************************************************
;                    LABORATORIO 8 - SCI CON TERMINAL PUTTY
;*******************************************************************************
#include registers.inc
;*******************************************************************************

;*******************************************************************************
;                  RELOCALIZACION DE VECTORES DE INTERRUPCIONES
;*******************************************************************************

                ORG $3E54
             dw SC1_ISR

;*******************************************************************************
;                            ESTRUCTURAS DE DATOS
;*******************************************************************************

                ORG $1000
                
EOM:            EQU $FF

Puntero:        ds 2

MSG:            FCC "Probando"
                db EOM

;*******************************************************************************
;                             PROGRAMA PRINCIPAL
;*******************************************************************************

                ORG $2000
Com_Serie
                Movw #39,SC1BDH
                Movb #$00,SC1CR1
                Movb #$48,SC1CR2; $88
                
                Ldaa SC1SR1
                Movb #$00,SC1DRL
                
                Lds #$3BFF
                Cli
                Ldd #MSG
                Std Puntero
                
                Ldaa SC1SR1
                Movb #$0C,SC1DRL
                
                Bra *
;*******************************************************************************
;                  SUBRUTINA DE ATENCION A INTERRUPCION SC1
;*******************************************************************************

SC1_ISR
                Ldaa SC1SR1
                Ldx Puntero
                Ldaa 1,X+
                Cmpa #EOM
                Bne Save
                BClr SC1CR2,$08
                Bra FIN_SC1_ISR
Save            Staa SC1DRL
                Stx Puntero
FIN_SC1_ISR     Rti
                
                
                